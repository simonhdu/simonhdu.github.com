!function(e){function t(e,t){if(e&&e.default_url){var n=this;if(this._timeout_handler=null,void 0!==e.timeout&&/^\d+$/.test(e.timeout)&&(this._timeout_handler=setTimeout(function(){e.func_timeout&&e.func_timeout()},1e3*e.timeout)),this._elm_head=null,this._missions=[],this._status_mission_start=!1,!this.get_url_string_by_symbol(t,"#")){var i=this.get_searchs(t);return e.local_data_keys&&this.save_search_data(i,e.local_data_keys),void(e.before_load?e.before_load(function(){clearTimeout(n._timeout_handler),n.page_url_init(t,i,e.default_url,e.call_keys),n._after_hashchange(e)},this):(clearTimeout(this._timeout_handler),this.page_url_init(t,i,e.default_url,e.call_keys),this._after_hashchange(e)))}this._after_hashchange(e)}}t.prototype={_after_hashchange:function(e){var t=this;e.on_load&&this.mission_push(e.on_load),e.resources&&e.resources.length&&this.mission_push(function(n){t.load_resouce(e.resources,n)}),e.complete&&this.mission_push(e.complete),this.mission_start()},mission_push:function(e){this._missions.push(e)},mission_start:function(){this._status_mission_start||(this._status_mission_start=!0,this._mission_next())},_mission_next:function(){if(this._missions&&this._missions.length){var e=this._missions.shift(),t=this;e(function(){t._missions.length||clearTimeout(t._timeout_handler),t._mission_next()},this)}},_get_source_obj:function(e){if(!e||!e.length)return!1;for(var t,n,i=0,s=e.length,o={},_=0,r={},a=0,u=!1;s>i;i++)it=e[i],it&&("object"==typeof it&&it.depend?(u=!0,r[it.path]=it,a++):(o[it]={is_load:!1},_++));var d;for(i in r)for(it=r[i],t=0,n=it.depend.length;n>t;t++)d=it.depend[t],r[d]||o[d]||(o[d]={is_load:!1},_++);return{has_depend:u,o_undepend:o,n_undepend:_,o_depend:r,n_depend:a}},_get_doc_obj:function(){if(!this._elm_head){var e=document,t=e.getElementsByTagName("head")[0]||e.documentElement;this._elm_head=t}return this._elm_head},_require_resource:function(e,t){var n,i=this._get_doc_obj(),s="";/\.css/.test(e)?(n=document.createElement("link"),n.href=e+s,n.type="text/css",n.rel="stylesheet",t&&t(e)):/\.js/.test(e)&&(n=document.createElement("script"),n.type="text/javascript",n.src=e+s,n.onload=function(){t&&t(e)}),n&&i.appendChild(n)},_is_depend_resouces_load:function(e,t){for(var n,i=e.depend,s=0,o=i.length;o>s;s++)if(n=i[s],!t[n]||!t[n].is_load)return!1;return!0},load_resouce:function(e,t){var n,i,s=this._get_source_obj(e),o=s.n_undepend,_=s.has_depend?function(e){s.o_undepend[e]&&(s.o_undepend[e].is_load=!0),o--,o||n&&n(t)}:function(){o--,o||t&&t()};for(i in s.o_undepend)this._require_resource(i,_);if(s.has_depend){var r=s.n_depend,a=this;n=function(e){if(!r)return void(e&&e());var t;for(i in s.o_depend)t=s.o_depend[i],a._is_depend_resouces_load(t,s.o_undepend)&&(delete s.o_depend[t.path],a._require_resource(i,function(t){r--,s.o_undepend[t]={is_load:!0},n(e)}))}}},get_url_string_by_symbol:function(e,t){var n=e.indexOf(t||"#");return-1===n?"":e.slice(n+1,e.length)},page_url_init:function(e,t,n,i){return location.href=this.page_jump_calc(e,t,n,i)},page_jump_calc:function(e,t,n,i){if(!t||!i)return n;var s,o,_,r,a,u;for(s in i){if(_)break;for(o=i[s],r=s.split("&"),a=0,u=r.length;u>a&&RegExp(r[a],"i").test(e);a++)a+1==u&&(_=o.replace(/\{\{([^}]*?)\}\}/g,function(e,n){return void 0!==t[n]?decodeURIComponent(t[n]):""}))}return _||n},save_search_data:function(e,t){if(e&&t&&t.length){for(var n,i=0,s=t.length;s>i;i++)n=t[i].split("::"),e[n[0]]&&window.sessionStorage&&window.sessionStorage.setItem(n[1],decodeURIComponent(e[n[0]]));return!0}},get_searchs:function(e){for(var t,n,i,s=e.slice(-1!==e.indexOf("?")?e.indexOf("?")+1:0,e.length),o={},_=0,r=s.split("&"),a=r.length;a>_;_++)t=r[_].split("="),0!==t.length&&(n=t[0],i=t[1],o[n]||""===i?o[n]&&(o[n]+=","+i):o[n]=i);return o}},e.Tatami||(e.Tatami={}),e.Tatami.onpageload=function(e,n){return new t(e,n)}}(window);